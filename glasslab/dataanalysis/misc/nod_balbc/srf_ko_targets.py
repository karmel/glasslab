'''
Created on Feb 15, 2013

@author: karmel
'''
from __future__ import division
from glasslab.dataanalysis.graphing.seq_grapher import SeqGrapher

if __name__ == '__main__':
    yzer = SeqGrapher()
    
    dirpath = 'karmel/Desktop/Projects/GlassLab/Notes_and_Reports/NOD_BALBc/ThioMacs/Analysis_2013_02/'
    dirpath = yzer.get_path(dirpath)
    img_dirpath = yzer.get_and_create_path(dirpath, 'srf_ko_targets')
    data = yzer.import_file(yzer.get_filename(dirpath, 'transcript_vectors.txt'))
    
    data = data.fillna(0)
    data = data[data[['nod_notx_1h_tag_count','balb_notx_1h_tag_count']].max(axis=1) >= 10]
    data = data[(data['has_refseq'] == 1) & (data['transcript_score'] >= 4)]
    
    # From Amy Sullivan SRF paper
    down_in_srf_ko = ['Cnn2','Srf','Lima1','Rhoj','Coro1a','Il1rn','Lsp1','LOC277203','Vcl','Card11','Cbr2','Cd83','Acta2','Actb','Tspan7','Ebi2','Gpr162','Ckb','Dhcr24','LOC638632','Actg2','Trim29','Ppap2b','Klk1b11','Actc1','Pcp4l1','LOC621324','Cdkn1c','Slco2b1','Cd24a','Pdgfa','Lrrc58','Dnmt3a','Slamf9','1100001H23Rik','Aldoc','Cd28','1500003O03Rik','Rab15','Pld4','Pilra','Xlr','Tgm1','Lcp1','Fstl1','Slc40a1','Usp24','Jup','Cd74','Tpm4','Fcgr1','Ccl9','BC025833','Ceacam2','Tnni2','Sema4d','Cd109','Zyx','Slco4a1','Tubb3','Fcgr3a','Ttc4','Cxcl13','C230021P08Rik','C530028O21Rik','Pdgfc','Ceacam1','Dnahc2','C1qb','Mcoln3','Sh2d1b1','1500031H01Rik','Odz4','Ccl5','E430024C06Rik','Pdxk','Ccl6','LOC622976','Sfrp5','Ebi3','3830403N18Rik','D14Ertd426e','Il10ra','4930431B09Rik','Clec5a','Lsr','Hyal1','Ccl4','Narf','L1cam','Gpr35','Map4k1','Rhoh','Rin3','Ppia','Pilrb','Trim16','Ceecam1','Ptpro','Igsf9','Acot11','Pfn1','Stac2','Ryr1','Pars2','Lhfp','Adrbk2','Gas7','2810417M05Rik','D10Bwg1379e','Arpc4','Sdc3','Cd72','1700026L06Rik','Tspan32','Sh3bgrl','Pstpip1','Gas6','Wfs1','Pld3','Rtp4','Axl','Psd4','Ccl3','Selm','Sh3bgrl2','Slc6a12','Eef1a2','Neurl2','LOC194985','Kcnq1','Zfp467','Ptrh1','C230093N12Rik','Cyp4f18','Slamf8','Tns1','Pex10','1200009I06Rik','Atg4c','Bsn','Il1a','Slc27a1','Angpt2','Lgals9','Nuak2','Xbp1','H2-Aa','Sorl1','Pctk3','Ttyh2','LOC623548','Mpp7','Ptpn22','Dbndd2','H2-Eb1','Mamdc2','Cmtm4','Nr2f6','Zfp385','Lmo2','Zfp36l2','Flna','Actn1','Ccr2','Irak2']
    up_in_srf_ko = ['Cbfa2t3h','Srxn1','Tanc2','Gabarapl1','Pex11a','H2-K1','Kif7','Dab2ip','Tgm2','Fzd1','Cd1d1','Mrpplf4','Mmp9','Mllt4','Phgdh','Tnfrsf12a','Asns','Mef2a','Esd','Cav2','Smad6','Flnb','Kazald1','Mettl7a','Maff','Cyp2j6','Eya4','Gtl2','Gpc1','Pde2a','Fkbp11','Arhgef12','5730528L13Rik','Creb5','Tmeff1','Fzd7','Mpdu1','Irf1','2300002D11Rik','Cbr3','Thbs1','Skil','Tal1','Maoa','Cbx2','Stab1','Siglecf','Gsta3','Plxdc2','Treml4','Klf10','Prokr1','Cldn23','Egr2','Cpne8','Slc27a6','Snn','Banp','2310043N10Rik','Id3','F3','Hyi','Eps8l1','Fos','Lrg1','Chac1','Hp','Cdca7','Cxcl12','Htra3','Dach1','Serpine1','Slc22a4','Cck','Wbscr27','Dlk1','Mgam','Tfrc','Ctgf','Chst3','Bdh2','Aqp9','Cox6a2','Enpp4','Htr2b','Phlda3','Cited4','Cxcl14','Htra4','Slc15a2','Galnt9','Lgi2','Arg1','Car6','H2-Q8','Mmp13','Hmga2','Fabp7','Egr1']
    actin = ['Cnn2','Srf','Rhoj','Coro1a','Actc1','Pdgfa','Lcp1','Pfn1','Gas7','Arpc4','Neurl2','Actn1']
    cytoskeleton = ['Cnn2','Lima1','Coro1a','Vcl','Acta2','Actb','Dhcr24','Actg2','Actc1','Lcp1','Jup','Tpm4','Tnni2','Zyx','Tubb3','Pfn1','Gas7','Arpc4','Pstpip1','Bsn','Flna','Actn1']
    
    # From GO
    cytoskeleton_part = ['Harbi1','Cnih2','Gas2l1','Appbp2','Cep350','Krt33b','Krt33a','Gm9507','Invs','Pibf1','Katnal2','Nf2','Nf1','Afap1','Nde1','Ranbp10','Shank3','Shank2','Shank1','Kif1a','Spatc1','Kif1b','Sos1','Dnali1','Syndig1','Kif1c','Drd2','Ska1','Wrn','Ska3','Ska2','Cep57','Homer1','Homer3','Mtap7d3','Rbm39','Topors','Lrrc45','Cep55','Snx4','Tacc3','Myom1','Nefh','Akt1','Aunip','Gys2','Ankrd32','Syne1','Ric8b','Picalm','Mlph','Naf1','14-Sep','Cep170','Vps18','Vps16','Krtap31-1','Krtap31-2','Sipa1l1','Pstpip1','Myo3b','C2cd3','Ccnb1','Gm14188','Dpysl3','Dst','Cep104','Prph','Smo','Gm7137','Flot1','Mkks','Krt6a','Wipf1','Gm7138','Stx1a','Kif16b','Mad2l1','Rab11fip5','Krt80','Krt81','Krt82','Krt83','Krt84','Krt85','Krt86','Gm3238','Pla2g6','Iqgap2','Nphp4','Ppp1r9a','Ndrg1','Arl3','Gm3233','Kif5a','Sass6','Tbccd1','Dynll1','Calm1','Camsap2','Camsap3','Camsap1','Clec11a','Klhl41','Abca2','Tsen2','Eml6','Sorbs1','Tubgcp2','Tubgcp3','Tubgcp4','Tubgcp5','Il1r1','Fnta','Stim1','Fntb','Numa1','Dync1i1','Tsks','Dync1i2','Dzip1l','Kif26a','Kif26b','Utrn','Keg1','Ttn','Ttl','Cdkl2','Tcp11l1','Myd88','Cald1','Rhoq','Map2','Prkcb','Tchp','Ift57','Dynlt1b','Arl2','Tssk2','Clip2','Clip1','Ccp110','Fblim1','Cript','Pdlim2','P2rx2','Tubb2a','P2rx4','P2rx6','Fsd1','1110008J03Rik','Sh3pxd2a','Nek2','Actg1','Nek1','Sbds','Ogt','Sgol1','Poc5','Hsph1','Ppp1r9b','AI314180','Lmna','Rttn','Aif1','Map6d1','Nudc','Cep170b','Incenp','Ppp2r3c','Evc','Als2','Cct8','Cabp1','Krtap19-3','Narf','Cfl1','Fbf1','Krtap21-1','Capn6','Ccdc64','Gm14181','Gm14180','Gm14187','Gm14185','Gm14184','Gria2','Gria3','Gria1','Serpinb6a','Gria4','Ccdc85b','Yeats2','Spag6','Palld','Atm','Arrb2','Fbxo5','Arrb1','12-Sep','Cep19','Pcm1','Ina','Mapk8ip2','Pla2g3','Naa11','Krtap4-2','Rab3ip','Mark4','Sclt1','Ak5','Gm10229','Apex1','Esrp2','Dhx9','Krtap4-7','Map7','Anxa11','Cct5','Myo7a','Lzts1','Vps41','Odf2l','2300003K06Rik','Trim32','Mphosph9','Tpm4','Tpm3','Tpm2','Tpm1','E4f1','Cep68','Mplkip','Klhl2','Ppp1r12a','Myo7b','Dclre1b','Dstn','Tuba1b','1110017D15Rik','Rab8a','Dbnl','Krt23','Krt20','Nav1','Krt26','Krt27','Krt24','Krt25','Ciao1','Acta1','Ndrg2','Tubd1','Gm10318','Aldob','Gm11939','Sac3d1','Ift80','Csnk1a1','Capza3','Capza2','Capza1','Klc3','Birc6','Birc5','Mylk2','Vps11','Wdr67','Gng12','Psma1','Gm10142','Lima1','Mst1r','Tuba1a','Cntln','Nox4','mt-Nd2','Apoe','Pcgf5','Dnahc2','Dnahc3','Usp2','Dnahc1','Stil','Tnfaip3','Dnahc5','Ctnnb1','Map2k5','Tuba4a','Chmp1a','Mzt1','Ppp1r42','Tmod4','Anxa2','Nme1','Tmod3','Gas8','Actc1','Hyls1','Cep135','Stard9','Rgcc','Gm1305','Bcas1','Plekha7','5-Sep','Cep63','4732456N10Rik','Map9','Ddhd2','Cdc14a','Ino80','Arl2bp','Gm7579','Fbxw11','Cdk5r1','Tuba8','Cdk5rap2','Lrrcc1','Prc1','Spag17','Cby1','Arhgef10','Meaf6','Dlgap5','Thap11','Inpp5d','Spast','Tspyl2','Ift81','Ift88','Tnni3','Coro1a','Polb','5830418K08Rik','Ncor1','Kncn','Tbl1x','Csk','Med28','Aspm','Gck','Pick1','Slain2','Krt222','Sh2b2','Pdzd2','Cdc42bpb','Krt16','Flna','Flnb','Kif20b','Ldlrap1','Cdc6','Kif20a','Fbxo45','Krt17','Rpp25','Map1lc3b','Stmn1','Fbxo40','Hsd17b14','Ccsap','H2afy','Dync2li1','Cdh23','Myo6','Cep97','Dcaf12','Aurka','Aurkb','Aurkc','Krt13','Pkd2','Actn4','Pcnt','Gm11563','Gm11567','Gm11564','Gm11565','Rassf5','Gm11568','Gm11569','Arhgef2','Clic4','Ilk','Lrrc49','Katna1','Pkp4','Pkp2','Sh3pxd2b','Ttll1','Grip2','Cct6a','Ninl','Lrpprc','Sirt2','Rgs14','Synm','Cys1','Cct2','Cct3','App','Ssna1','Sync','Cct4','Vim','Fez1','Mid1ip1','Arpc2','Wdr62','Apc','Arpc1a','Tmem67','Adora2a','Stau2','Bbs2','Synpo','Brsk2','Haus8','Ccnb2','Haus6','Haus7','Haus4','Haus5','Haus2','Haus3','Spag16','Haus1','Tubg1','Disc1','Tubg2','Mapt','Dync1h1','Myl6b','Gfap','Ttll5','Prkar2a','Hdac3','Ttll6','Bmf','Hdac4','Ttll3','Hdac6','Arpc3','Arpc1b','Lrp8','9-Sep','Ttll9','Ttll8','Arpc5','Gabarap','Mks1','Vapa','Ndel1','Ranbp9','Itpr1','Fscn1','Myh10','Myh11','Myh13','Myh14','Add2','Add1','Zfyve26','Ahi1','Dnahc10','Dnahc11','Dnahc12','Chrna7','Krt42','Strn','Map4','Dnahc17','Apc2','P2ry1','Tada3','Chd4','Myo3a','Kcnd2','Klhl21','Tbl1xr1','Cep250','Ccdc15','Cdc27','Ranbp1','Sptb','Tcte3','Kif19a','Tfap2a','Krt6b','Krtap12-1','Mapre1','Sarm1','Mapre3','Cul3','Dpf2','Psrc1','Iqcb1','Myl12b','Myl12a','Zfp828','Krtap6-3','Synj2','Vcl','Ptpn20','Krt2','Mefv','Rab3gap1','Krt7','Ttll10','Krt5','Krt4','Ift46','Dab1','Igf2bp2','Actr3','Krtap4-13','Srcin1','Myh15','Rp1','Cep128','Gm14192','Gm14194','Cnn3','Cnn2','Cep120','Gas7','Adam10','Spry2','Mtus2','Fgf13','Mlf1ip','Ndn','Mad2l2','Ccne1','Plk1','Erc2','Gm19402','Plk4','Brca2','Cyld','Eps8','Rfwd2','Slc1a4','Lzts2','Sptbn4','Sptbn2','Sptbn1','Mybpc2','Myh2','Myh3','Myh1','Myh6','Myh7','Myh4','Keap1','Pafah1b1','Myh8','Myh9','Katnal1','Cep57l1','1-Sep','Krtap19-2','Dnaic2','Dnaic1','Dlgap1','Arfgef2','Krtap19-5','Lasp1','Map6','Zw10','Kif2b','Ercc2','5430421N21Rik','Ncoa2','Pdlim5','Pdlim7','Axin2','Axin1','Spdl1','Nefm','Nefl','Chrna3','Alms1','Cep110','Pde4dip','Gm11559','Magi2','Fopnl','Gabarapl1','Actb','Mid2','Iqgap1','Gm11555','Gm11554','Pan3','Grin2b','Sema4c','Krtap16-1','Rmdn3','Krtap16-3','Rmdn1','Dnalc4','Katnb1','Fyn','Tln1','G6pdx','Adora1','Tcp1','Whrn','Ptpn12','Rabl6','Trim54','Vps37a','Gnai2','Lck','Krtap19-9b','Gnai1','Tnnt1','Nit2','Tnnt3','Tnnt2','Cep76','Bcl2l1','Dlg3','Cd2ap','Kif14','Kif15','Kif17','Kif11','Kif12','Wdr44','Espl1','Gm5414','Krtap29-1','Upp2','Uxt','Gm19668','Plcb4','Erbb4','Tubb6','Cdc25b','Enah','Tubb5','Tubb3','Slc25a5','Tubb1','Cacng8','Mtpn','Krt15','Krt14','Mybpc3','Krt12','Myzap','Krt10','Dzip1','4933427D14Rik','Cacng5','Krt19','Krt18','Actn3','Actn2','Actn1','Rac3','Src','Llgl1','Mylk','Brsk1','Gsk3b','Ccdc14','Myo5c','Fam110c','Bbs4','Krtap13-1','Grin1','Actr3b','Cbx3','Cbx1','Krtap4-16','Krtap26-1','Tpx2','Gm14190','Gm14178','Sdccag8','Gm10100','Cep152','Dynll2','Tcea2','Rpgr','Mapk14','Grin2c','Grin2a','Dcx','Gm14177','Camk2n1','Lmnb2','Nedd9','Lmnb1','Clasp2','Clasp1','Gm14179','Nedd1','Kntc1','Crhbp','Myl6','Myl7','Myl4','Nme7','Myl2','Myl3','Myl1','4922501C03Rik','Cep85','Myl9','Itga8','Cep89','Aaas','Spef2','Nme2','Tada2a','Crocc','Fkbp4','Cdk1','Ptk2b','Cep70','Cdk5','Cep72','Cep290','Trip10','Flii','Pea15a','Kifc2','Kifc3','Bnip2','Kifc1','Rb1','Nebl','Tppp','Odf2','Gm11596','Kif5b','Kif5c','Cryab','Adam8','Srgap2','Krt28','Kif13a','Kif13b','Aatf','Myo9b','Myo9a','Cobl','Dnm1l','Fam96b','Gja1','Gm3250','Sorbs2','Smad4','Pde4d','Tppp3','Krtap10-4','Kif18a','Vil1','Dsp','Kif18b','Jup','Tbcb','Tubgcp6','Gsg2','Nudt21','Amot','Cep112','Ywhaz','Tnnc2','Macf1','Bloc1s2b','Cetn4','Krt40','Cetn2','Cetn1','Ttc8','Psen1','Bloc1s2a','Kif21a','Kif21b','Sytl4','Tubal3','Tlk2','Tmsb15b2','Krt1','Spta1','Parp4','Azi1','Wasl','Dctn2','Dctn3','Ttc26','Dctn1','Dctn6','Dctn4','Dctn5','Krtap5-4','Krtap5-5','Pard3','Myh7b','Krtap5-1','Krtap5-2','Krtap5-3','Mid1','1700011A15Rik','Cacna1c','Casp8','Cap1','Hepacam2','2700049A03Rik','Ctnnd2','Kifap3','Pkhd1','Cdca8','Npm1','Krt9','Tbca','Gm10024','Map1a','Map1b','Krt8','Klhl17','Tuba1c','Kif24','Kif27','Pax2','Kif23','Kif22','Shroom3','Shroom2','Shroom1','Map1s','Polr3h','Shroom4','Arhgap4','Fgfr1op','Brca1','Lurap1','Akap5','Mapre2','Gm14191','Rassf1','Cep44','Rassf3','Kif6','Akap9','Fermt2','Fermt3','Fermt1','Dnm1','Fbxl7','Dnm3','Dnm2','Dynlrb2','Nin','Dynlrb1','Diap1','Arpc4','Chd3','Cct7','Sntb2','Gm14196','Hipk2','Il1rn','Cep78','Krtap6-5','Actr10','Bfsp2','Krtap6-2','Nsf','Bfsp1','Dvl1','D7Ertd443e','Dync1li1','Dync1li2','Fkbp15','Cdc45','Ywhae','Kif2a','Slc9a3r1','Kif2c','Cdc42','Capzb','Hook1','Ccdc105','Psen2','Ptpn11','Gnai3','Mycbp','Plk3','Ankrd26','Neto1','Myo5b','Myo5a','Wdr35','Dtl','Lpxn','Grid2','Arl8b','Ift172','Arl8a','Plk2','Ctsg','Lancl2','Pinx1','Anln','Tnnc1','Scnn1a','Krtap17-1','Ezr','Pin4','Gm11595','Nr3c1','Cenpj','Chek1','Cenpf','Cenpe','Micall2','Unc119','Kdm4a','Marcks','Mylpf','Mdh1','Ckap2','Cenpv','Tnks2','Pbxip1','Mak','Ckap5','Rcc2','11-Sep','Eml2','Eml3','Umod','Krt72','Kat2b','Eml4','Eml5','Ptges3','Csnk1d','Tchh','Cltc','Prkaca','Rpgrip1l','Lyn','Kif3a','Dlc1','8-Sep','Krt75','Krt74','Lphn1','Krt76','Krt71','Krtap1-5','Krt73','Kif9','Racgap1','Kif7','Kif4','Krt79','Krt78','Camk2b','Krtap3-1','Ccdc28b','Dnahc8','Mcm3','Kat2a','Ifltd1','Neil2','Nes','Rps6ka1','Rps6ka2','Vmac','Daam1','Mib1','Tuba-rs1','Met','Cgnl1','Pcif1','Ofd1','Tubb2b','Ift74','Tekt3','Rab11fip3','Tuba3a','Eml1','Ift20','Poc1a','Poc1b','Traf5','Ckap2l','Tekt4','Spin1','Prkacb','Wdr47','Wrap73','Cep192','Baalc','Cdc16','4-Sep','Bmyc','Myc','Zyx','Mybph','Krtap4-9','Krtap4-8','Jakmip1','Krtap7-1','Krtap4-1','Krtap9-1','Spag4','Spag5','Spice1','Krtap9-5','Dynlt3','Krtap4-6','Krtap13','Krtap14','3-Sep','Ncapg','Klc1','Klc2','Tmsb15l','Klc4','Fam161a','Maea','Nicn1','Nfu1','Actr2','Gtse1','Krt77','Rock2','Ccnf','B9d2','Krtap1-3','Trpv4','Map1lc3a','Krtap1-4','Ctdp1','Dync2h1','Tpgs1','Cep95','Ccdc77','Slc8a2','Kif8','Ect2','Ss18','6-Sep','10-Sep','Epha4','Bbs5','Krtap9-3','Bbs7','Snap91','Lats2','Lats1','Prkar2b','Mzt2','Vcam1','Casp14','2-Sep','Procr','Knstrn','Ptpn23','Sptan1','Exoc7','Exoc4','Neb','Tfpt','Des','Mns1','Tnni2','Ifngr1','Tnni1','Dlg1','Txndc9','Ift140','Nusap1','Dlg4','Ddx11','Tubb4b','Tubb4a','B9d1','Fhl3','Nfe2l2','Htt','Wee2','Plk1s1','Cdc42bpa','Krt39','Nos1','Myo1d','Tsga14','Cnp','Emd','Krt31','Pgm5','Krt32','Krt35','Krt34','Krt36','Map3k11','Rusc1','Cdc42bpg','Chrm1','Rap1gap2','Dtnbp1','Lcp1','Tsc2','Nrp1','Tube1','Tsc1','Cgn','Hook2','Hook3','Smc3','Lrrc7','Mastl','Casc1','Trnt1','Prosapip1','Map2k2','Map2k1','Krtap19-1','Pifo','Myo19','Yif1a','Ccdc92','Myo16','Myo15','Kif3b','Kif3c','Myo10','Obscn','Fhod3','Dis3l','Krtap19-4','Zfp110','Cep164','Tekt1','Cetn3','Cspp1','Tekt2','Grik5','Eif6','Park2','Cntrob','Bbs1','Prkcz','Ntrk2','7-Sep','Slc8a1','Tpgs2','Slc8a3','Ptch1','Krtap8-1','Pawr','Mms19','Gm10013','Cdc20','Espn','Myo1h','Myo1g','Myo1f','Myo1e','Chrm4','Myo1c','Myo1b','Myo1a','Pxk','Myo18a','Myo18b','Actr1b','Actr1a','Grm5','Grm1','Sharpin','Grm3']
    
    srf_upreg = data[data['gene_names'].isin(down_in_srf_ko)]      
    srf_repressed = data[data['gene_names'].isin(up_in_srf_ko)]
    actin_srf = data[data['gene_names'].isin(actin)]
    cyto_srf = data[data['gene_names'].isin(cytoskeleton)]
    cyto_all = data[data['gene_names'].isin(cytoskeleton_part)]
    
    vals = [d['balb_nod_notx_1h_fc'] for d in (srf_upreg, srf_repressed, actin_srf, cyto_srf, cyto_all)]
    labels = ['SRF Dependent Genes', 'Genes Repressed by SRF', 
              'SRF Dependent Actin Genes', 'SRF Dependent Cytoskeleton Genes',
              'GO:0044430 Cytoskeleton Part']
    labels = [l + '\n(count: {0})'.format(len(v)) for l,v in zip(labels, vals)]
    title = 'Balbc vs NOD Log-fold Change in SRF Target Genes'
    if True:
        ax = yzer.boxplot(vals, labels, 
                         title=title, xlabel='Gene Group', 
                         ylabel='log2(NOD notx 1h GRO-seq/BALBc notx 1h GRO-seq)', 
                         show_outliers=False, show_plot=True, wide=True,
                         save_dir=img_dirpath)
